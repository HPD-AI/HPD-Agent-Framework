# Skills

Skills are multi-function workflows that group related AIFunctions with shared instructions. When the agent activates a skill, it expands to reveal its constituent functions along with guidance on how to use them together.

## What Are Skills?

Think of a skill as a "mode" the agent can enter:

```
Before activation:              After activation:
┌─────────────────────┐         ┌─────────────────────┐
│ Research Skill      │   ──►   │ WebSearch           │
│ "Deep research..."  │         │ CodeSearch          │
└─────────────────────┘         │ DocumentSearch      │
                                │                     │
                                │ Instructions:       │
                                │ 1. Search web first │
                                │ 2. Search code...   │
                                └─────────────────────┘
```

**Key differences from plain AIFunctions:**
- Skills provide **instructions** that guide the agent's workflow
- Skills **reference** existing functions rather than defining new ones
- Skills can include **documents** for additional context

---

## Basic Usage

Mark a method with `[Skill]` and return a `Skill` object:

```csharp
public class SearchPlugin
{
    [AIFunction]
    public async Task<string> WebSearch(string query) { /* ... */ }

    [AIFunction]
    public async Task<string> CodeSearch(string query) { /* ... */ }

    [Skill]
    public Skill ResearchSkill()
    {
        return SkillFactory.Create(
            name: "Research",
            description: "Deep research across web and code",
            instructions: @"
                1. Start with WebSearch for general context
                2. Use CodeSearch for implementation details
                3. Synthesize findings into a coherent summary",
            "SearchPlugin.WebSearch",
            "SearchPlugin.CodeSearch"
        );
    }
}
```

---

## SkillFactory.Create()

### Basic Signature

```csharp
public static Skill Create(
    string name,           // Skill identifier (becomes the tool name)
    string description,    // Shown in tools list before activation
    string instructions,   // Injected after activation
    params string[] references  // "PluginName.FunctionName" format
)
```

### With Options

```csharp
public static Skill Create(
    string name,
    string description,
    string instructions,
    SkillOptions? options,      // Documents and additional config
    params string[] references
)
```

---

## Function References

References use the format `"PluginName.FunctionName"`:

```csharp
return SkillFactory.Create(
    name: "DataAnalysis",
    description: "Analyze data from multiple sources",
    instructions: "...",
    "DatabasePlugin.Query",        // Reference function from another plugin
    "FileSystemPlugin.ReadFile",   // Mix functions from different plugins
    "SearchPlugin.WebSearch"       // Same plugin is fine too
);
```

**Important:** Referenced functions must exist in registered plugins. The source generator validates references at compile time when possible.

---

## Skill Documents

Skills can include documents that provide additional context when activated.

### SkillOptions

```csharp
public class SkillOptions
{
    // Reference an existing document in the document store
    public SkillOptions AddDocument(
        string documentId,
        string? description = null)

    // Upload a document from a file
    public SkillOptions AddDocumentFromFile(
        string filePath,
        string description,
        string? documentId = null)

    // Upload a document from a URL
    public SkillOptions AddDocumentFromUrl(
        string url,
        string description,
        string? documentId = null)
}
```

### Example with Documents

```csharp
[Skill]
public Skill CodeReviewSkill()
{
    var options = new SkillOptions()
        .AddDocumentFromFile(
            "docs/code-standards.md",
            "Company coding standards and best practices")
        .AddDocument(
            "style-guide",
            "Official style guide");

    return SkillFactory.Create(
        name: "Code Review",
        description: "Review code for quality and standards compliance",
        instructions: @"
            1. Read the code-standards document first
            2. Check each file against the standards
            3. Provide specific, actionable feedback",
        options,
        "FileSystemPlugin.ReadFile",
        "FileSystemPlugin.ListDirectory"
    );
}
```

### Document Store Setup

To use documents, register a document store with the agent:

```csharp
var agent = new AgentBuilder()
    .WithDocumentStore(documentStore)
    .WithPlugin<ReviewPlugin>()
    .Build();
```

---

## How Skill Expansion Works

When the agent "calls" a skill, the following happens:

1. **Container expands**: The skill tool is replaced by its referenced functions
2. **Instructions injected**: Skill instructions are added to guide the agent
3. **Documents available**: Any attached documents become accessible
4. **Agent proceeds**: Uses the expanded functions with instruction guidance

```
Agent's view before:
┌─────────────────────────────────┐
│ Tools: Research, SendEmail,... │
└─────────────────────────────────┘

Agent activates "Research" skill...

Agent's view after:
┌─────────────────────────────────┐
│ Tools: WebSearch, CodeSearch,  │
│        SendEmail,...           │
│                                │
│ Instructions:                  │
│ 1. Start with WebSearch...     │
└─────────────────────────────────┘
```

---

## Requiring Permission

Skills can require user approval before activation:

```csharp
[Skill]
[RequiresPermission]
public Skill DeploymentSkill()
{
    return SkillFactory.Create(
        name: "Deploy",
        description: "Deploy application to production",
        instructions: "...",
        "DeployPlugin.BuildApp",
        "DeployPlugin.RunTests",
        "DeployPlugin.Deploy"
    );
}
```

---

## Typed Metadata

For compile-time validation, use the generic attribute:

```csharp
public class SearchMetadata : IPluginMetadata
{
    public bool HasMultipleProviders { get; set; }
    // Implementation...
}

public class SearchPlugin
{
    [Skill<SearchMetadata>]
    public Skill AdvancedResearch()
    {
        return SkillFactory.Create(
            name: "Advanced Research",
            description: "Research with multiple provider support",
            instructions: "...",
            "SearchPlugin.WebSearch",
            "SearchPlugin.CodeSearch"
        );
    }
}
```

→ See [02.1.4 Plugin Metadata.md](02.1.4%20Plugin%20Metadata.md) for details.

---

## Conditional Skills

Show or hide skills based on runtime conditions:

```csharp
[Skill]
[ConditionalSkill("HasMultipleProviders")]
public Skill MultiProviderSearch()
{
    // Only visible when metadata.HasMultipleProviders is true
    return SkillFactory.Create(
        name: "Multi-Provider Search",
        description: "Search across multiple providers simultaneously",
        instructions: "...",
        "SearchPlugin.TavilySearch",
        "SearchPlugin.BingSearch",
        "SearchPlugin.GoogleSearch"
    );
}
```

→ See [02.1.4 Plugin Metadata.md](02.1.4%20Plugin%20Metadata.md) for conditional registration details.

---

## Skills vs Collapsed Plugins

Both skills and collapsed plugins group functions, but they serve different purposes:

| Aspect | Skill | Collapsed Plugin |
|--------|-------|------------------|
| **Purpose** | Workflow with instructions | Reduce context clutter |
| **Instructions** | Yes, detailed workflow guidance | Brief, optional |
| **Scope** | Can reference functions across plugins | Single plugin only |
| **Documents** | Supports attached documents | No |
| **Activation** | Explicit "use this skill" | Implicit on first function call |

**Use Skills when:** You need to guide the agent through a multi-step workflow.

**Use Collapse when:** You just want to reduce the number of visible tools.

---

## Best Practices

1. **Write clear instructions**: Skills are powerful because of their guidance. Be specific about the workflow.

2. **Keep skills focused**: A skill should represent one coherent workflow, not a grab-bag of functions.

3. **Reference only what's needed**: Don't include every function—just the ones relevant to the workflow.

4. **Use documents wisely**: Include documents that provide essential context, not everything tangentially related.

5. **Name skills as actions**: "Research", "Deploy", "Review" are better than "ResearchSkill" or "SearchFunctions".

```csharp
// Good: Focused workflow with clear instructions
[Skill]
public Skill BugInvestigation()
{
    return SkillFactory.Create(
        name: "Investigate Bug",
        description: "Systematically investigate and diagnose a bug",
        instructions: @"
            1. Reproduce the issue using the provided steps
            2. Search codebase for related error messages
            3. Check recent commits for relevant changes
            4. Identify root cause before suggesting fixes",
        "FileSystemPlugin.ReadFile",
        "GitPlugin.Log",
        "GitPlugin.Diff",
        "SearchPlugin.CodeSearch"
    );
}

// Bad: Vague, too broad, no real guidance
[Skill]
public Skill DoStuff()
{
    return SkillFactory.Create(
        name: "Do Stuff",
        description: "Various operations",
        instructions: "Use these functions as needed",
        "Plugin1.Func1", "Plugin1.Func2", "Plugin2.Func1",
        "Plugin2.Func2", "Plugin3.Func1"  // Too many unrelated functions
    );
}
```

---

## Next Steps

- [02.1.3 SubAgents.md](02.1.3%20SubAgents.md) - Delegated agents for complex tasks
- [02.1.4 Plugin Metadata.md](02.1.4%20Plugin%20Metadata.md) - Dynamic descriptions and conditionals
- [02.1.5 Context Engineering.md](02.1.5%20Context%20Engineering.md) - Context management
